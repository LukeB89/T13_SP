{"ast":null,"code":"var _jsxFileName = \"/Users/evanbyrnes/Pycharm-python-workspace/T13_SP/client/src/App.js\";\n// Importing outside developed components.\nimport React, { useState, Component } from \"react\";\nimport { useLoadScript, GoogleMap, Marker, InfoWindow, MarkerClusterer, DirectionsService, DirectionsRenderer } from \"@react-google-maps/api\";\nimport Container from \"react-bootstrap/Container\";\nimport Button from \"react-bootstrap/Button\";\nimport Form from \"react-bootstrap/Form\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport styled from \"styled-components\"; // Importing self-developed components.\n\nimport Api from \"./components/Api\";\nimport DateTimeSelector from \"./components/DateTimeSelector\";\nimport BrandBar from \"./components/BrandBar\"; // Importing outside developed css.\n\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"@reach/combobox/styles.css\"; // Importing the Dublin Bus API stops data\n\nimport * as data from \"./data/db-stops.json\"; // Importing Google Maps Api Key.\n\nimport googleMapApiKey from \"./config\";\nconst google = window.google; // Defined styling for separation of page displayed.\n\nconst Wrapper = styled.main`\n  width: 100%;\n  height: 100%;\n`; // Importing custom styles to customize the style of Google Map.\n// Important for including and excluding markers etc.\n\nconst styles = require(\"./data/GoogleMapStyles.json\"); // Defined custom styles and location for Google Map.\n\n\nconst mapOptions = {\n  styles: styles,\n  disableDefaultUI: true,\n  zoomControl: true\n};\nconst mapContainerStyle = {\n  height: \"94vh\"\n}; // consts: [53.349804, -6.260310] - Dublin\n\nconst dublinCenter = {\n  lat: 53.349804,\n  lng: -6.30131\n}; // Icon used to represent a bus stop on the map.\n\nconst icon = {\n  url: \"/bus_icon.svg\",\n  scaledSize: {\n    width: 18,\n    height: 18\n  }\n}; // Icons used when Markers are clustered.\n\nconst options = {\n  imagePath: \"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m\"\n}; // Parsing the Stops data into various object shapes.\n\nconst rawData = data.results;\nconst myStops = rawData.map(stop => ({\n  description: \"Stop \" + stop.stopid + \", \" + stop.fullname,\n  type: \"Feature\",\n  properties: {\n    id: stop.stopid,\n    fullname: stop.fullname,\n    routes: stop.operators[0].routes\n  },\n  geometry: {\n    type: \"Point\",\n    pos: {\n      lat: parseFloat(stop.latitude),\n      lng: parseFloat(stop.longitude)\n    }\n  }\n}));\nconst parsedStops = myStops.map(parsed => ({\n  id: parsed.properties.id,\n  description: parsed.description,\n  geometry: parsed.geometry.pos\n})); // An array that contains only the names of all the stops.\n\nconst stopDescriptions = [];\n\nfor (var i = 0; i < parsedStops.length; i++) {\n  stopDescriptions.push(parsedStops[i].description);\n} // we want to make these variable values, to be able to\n// pass this information from what has been selected above.\n// origin = new window.google.maps.LatLng(53.3472419444, -6.2587911111),\n// const origin = { lat: 53.3472419444, lng: -6.2587911111 };\n// destination = new window.google.maps.LatLng(53.3466669444, -6.258325),\n\n\nconst destination = {\n  lat: 53.3466669444,\n  lng: -6.258325\n}; // Main function to draw the Map/Page.\n\nexport default function App() {\n  const {\n    isLoaded,\n    loadError\n  } = useLoadScript({\n    googleMapsApiKey: googleMapApiKey\n  });\n  const [center, setCenter] = useState(dublinCenter);\n  const [zoom, setZoom] = useState(11); // The things we need to track in state\n\n  const [selectedPlace, setSelectedPlace] = useState(null);\n  const [markerMap, setMarkerMap] = useState({});\n  const [infoOpen, setInfoOpen] = useState(false); // const [origin, setOrigin] = useState([]);\n  // const [destination, setDestination] = useState({});\n\n  const [response, setResponse] = useState({});\n  const directionsCallback = React.useCallback(response => {\n    console.log(\"hi, \", response);\n\n    if (response !== null) {\n      if (response.status === \"OK\") {\n        setResponse(response => ({\n          response\n        }));\n      } else {\n        console.log(\"response: \", response);\n      }\n    }\n  }, []);\n  const [markers, setMarkers] = React.useState([]);\n  const [selected, setSelected] = React.useState(null);\n  const mapRef = React.useRef();\n  const onMapLoad = React.useCallback(map => {\n    mapRef.current = map;\n  }, []);\n  const panTo = React.useCallback(({\n    lat,\n    lng\n  }) => {\n    mapRef.current.panTo({\n      lat,\n      lng\n    });\n    mapRef.current.setZoom(16); //\n\n    setMarkers(current => [...current, {\n      lat: lat,\n      lng: lng\n    }]);\n    console.log(markers); // setOrigin((current) => [...current, { lat: lat, lng: lng }]);\n  }, []); // We have to create a mapping of our places to actual Marker objects\n\n  const markerLoadHandler = (marker, stop) => {\n    return setMarkerMap(prevState => {\n      return { ...prevState,\n        [stop.properties.id]: marker\n      };\n    });\n  };\n\n  const markerClickHandler = (event, place) => {\n    // Remember which stop was clicked\n    setSelectedPlace(place); // Required so clicking a 2nd marker works as expected\n\n    if (infoOpen) {\n      setInfoOpen(false);\n    }\n\n    setInfoOpen(true);\n  };\n\n  if (loadError) return \"Error\";\n  if (!isLoaded) return \"Loading...\";\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    fluid: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(BrandBar, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Wrapper, {\n    style: {\n      width: \"75%\",\n      float: \"left\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(GoogleMap, {\n    mapContainerStyle: mapContainerStyle,\n    center: center,\n    zoom: zoom,\n    maxZoom: 13,\n    options: mapOptions,\n    onLoad: onMapLoad,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Locate, {\n    panTo: panTo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(MarkerClusterer, {\n    options: options,\n    maxZoom: 16,\n    minimumClusterSize: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 13\n    }\n  }, clusterer => myStops.map(stop => /*#__PURE__*/React.createElement(Marker, {\n    icon: icon,\n    key: stop.properties.id,\n    position: stop.geometry.pos,\n    clusterer: clusterer,\n    onLoad: marker => markerLoadHandler(marker, stop),\n    onClick: event => markerClickHandler(event, stop),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 19\n    }\n  }))), infoOpen && selectedPlace && /*#__PURE__*/React.createElement(InfoWindow, {\n    anchor: markerMap[selectedPlace.properties.id],\n    onCloseClick: () => setInfoOpen(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 19\n    }\n  }, \"Stop Number: \", selectedPlace.properties.id), /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 19\n    }\n  }, \"Routes: \", selectedPlace.properties.routes.join(\", \")))), markers.map(marker => /*#__PURE__*/React.createElement(Marker, {\n    key: `${marker.lat}-${marker.lng}`,\n    position: {\n      lat: marker.lat,\n      lng: marker.lng\n    },\n    onClick: () => {\n      setSelected(marker);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 15\n    }\n  })), destination !== \"\" && origin !== \"\" && /*#__PURE__*/React.createElement(DirectionsService // required\n  , {\n    options: {\n      origin: new window.google.maps.LatLng(53.3472419444, -6.2587911111),\n      destination: new window.google.maps.LatLng(53.3466669444, -6.258325),\n      travelMode: \"DRIVING\"\n    } // required\n    ,\n    callback: directionsCallback,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 15\n    }\n  }), response !== null && /*#__PURE__*/React.createElement(DirectionsRenderer // required\n  , {\n    options: {\n      directions: response\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 15\n    }\n  }))), /*#__PURE__*/React.createElement(Wrapper, {\n    style: {\n      width: \"25%\",\n      float: \"right\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    style: {\n      paddingTop: \"15vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(DateTimeSelector, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"formDeparture\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 17\n    }\n  }, \"Departure\"), /*#__PURE__*/React.createElement(Search, {\n    panTo: panTo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(Form, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Form.Group, {\n    controlId: \"formArrival\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 17\n    }\n  }, \"Arrival\"), /*#__PURE__*/React.createElement(Search, {\n    panTo: panTo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 17\n    }\n  })))))));\n} // Function to adjust the map to user location.\n\nfunction Locate({\n  panTo\n}) {\n  return /*#__PURE__*/React.createElement(\"button\", {\n    className: \"locate\",\n    onClick: () => {\n      navigator.geolocation.getCurrentPosition( // Hard coding Dublin for the time being.\n      position => {\n        panTo({\n          // lat: position.coords.latitude,\n          // lng: position.coords.longitude,\n          lat: dublinCenter.lat,\n          lng: dublinCenter.lng\n        });\n      }, () => null);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"compass\",\n    src: \"/compass.svg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 7\n    }\n  }));\n} // Function to adjust the map to user selected stop(s).\n\n\nfunction Search({\n  panTo\n}) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Typeahead, {\n    id: \"basic-example\",\n    options: stopDescriptions,\n    maxVisible: 2,\n    placeholder: \"Choose a stop...\",\n    onChange: address => {\n      try {\n        for (var i = 0; i < parsedStops.length; i++) {\n          if (address == parsedStops[i].description) {\n            const lat = parsedStops[i].geometry.lat,\n                  lng = parsedStops[i].geometry.lng;\n            panTo({\n              lat,\n              lng\n            });\n          }\n        }\n      } catch (error) {\n        console.log(\"error\");\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["/Users/evanbyrnes/Pycharm-python-workspace/T13_SP/client/src/App.js"],"names":["React","useState","Component","useLoadScript","GoogleMap","Marker","InfoWindow","MarkerClusterer","DirectionsService","DirectionsRenderer","Container","Button","Form","Typeahead","styled","Api","DateTimeSelector","BrandBar","data","googleMapApiKey","google","window","Wrapper","main","styles","require","mapOptions","disableDefaultUI","zoomControl","mapContainerStyle","height","dublinCenter","lat","lng","icon","url","scaledSize","width","options","imagePath","rawData","results","myStops","map","stop","description","stopid","fullname","type","properties","id","routes","operators","geometry","pos","parseFloat","latitude","longitude","parsedStops","parsed","stopDescriptions","i","length","push","destination","App","isLoaded","loadError","googleMapsApiKey","center","setCenter","zoom","setZoom","selectedPlace","setSelectedPlace","markerMap","setMarkerMap","infoOpen","setInfoOpen","response","setResponse","directionsCallback","useCallback","console","log","status","markers","setMarkers","selected","setSelected","mapRef","useRef","onMapLoad","current","panTo","markerLoadHandler","marker","prevState","markerClickHandler","event","place","float","clusterer","join","origin","maps","LatLng","travelMode","directions","paddingTop","Locate","navigator","geolocation","getCurrentPosition","position","Search","address","error"],"mappings":"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","sourcesContent":["// Importing outside developed components.\nimport React, { useState, Component } from \"react\";\nimport {\n  useLoadScript,\n  GoogleMap,\n  Marker,\n  InfoWindow,\n  MarkerClusterer,\n  DirectionsService,\n  DirectionsRenderer,\n} from \"@react-google-maps/api\";\nimport Container from \"react-bootstrap/Container\";\nimport Button from \"react-bootstrap/Button\";\nimport Form from \"react-bootstrap/Form\";\nimport { Typeahead } from \"react-bootstrap-typeahead\";\nimport styled from \"styled-components\";\n// Importing self-developed components.\nimport Api from \"./components/Api\";\nimport DateTimeSelector from \"./components/DateTimeSelector\";\nimport BrandBar from \"./components/BrandBar\";\n// Importing outside developed css.\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"@reach/combobox/styles.css\";\n// Importing the Dublin Bus API stops data\nimport * as data from \"./data/db-stops.json\";\n// Importing Google Maps Api Key.\nimport googleMapApiKey from \"./config\";\nconst google = window.google;\n// Defined styling for separation of page displayed.\nconst Wrapper = styled.main`\n  width: 100%;\n  height: 100%;\n`;\n// Importing custom styles to customize the style of Google Map.\n// Important for including and excluding markers etc.\nconst styles = require(\"./data/GoogleMapStyles.json\");\n// Defined custom styles and location for Google Map.\nconst mapOptions = {\n  styles: styles,\n  disableDefaultUI: true,\n  zoomControl: true,\n};\nconst mapContainerStyle = {\n  height: \"94vh\",\n};\n// consts: [53.349804, -6.260310] - Dublin\nconst dublinCenter = {\n  lat: 53.349804,\n  lng: -6.30131,\n};\n// Icon used to represent a bus stop on the map.\nconst icon = {\n  url: \"/bus_icon.svg\",\n  scaledSize: { width: 18, height: 18 },\n};\n// Icons used when Markers are clustered.\nconst options = {\n  imagePath:\n    \"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m\",\n};\n// Parsing the Stops data into various object shapes.\nconst rawData = data.results;\nconst myStops = rawData.map((stop) => ({\n  description: \"Stop \" + stop.stopid + \", \" + stop.fullname,\n  type: \"Feature\",\n  properties: {\n    id: stop.stopid,\n    fullname: stop.fullname,\n    routes: stop.operators[0].routes,\n  },\n  geometry: {\n    type: \"Point\",\n    pos: {\n      lat: parseFloat(stop.latitude),\n      lng: parseFloat(stop.longitude),\n    },\n  },\n}));\nconst parsedStops = myStops.map((parsed) => ({\n  id: parsed.properties.id,\n  description: parsed.description,\n  geometry: parsed.geometry.pos,\n}));\n// An array that contains only the names of all the stops.\nconst stopDescriptions = [];\nfor (var i = 0; i < parsedStops.length; i++) {\n  stopDescriptions.push(parsedStops[i].description);\n}\n\n// we want to make these variable values, to be able to\n// pass this information from what has been selected above.\n// origin = new window.google.maps.LatLng(53.3472419444, -6.2587911111),\n// const origin = { lat: 53.3472419444, lng: -6.2587911111 };\n// destination = new window.google.maps.LatLng(53.3466669444, -6.258325),\nconst destination = { lat: 53.3466669444, lng: -6.258325 };\n// Main function to draw the Map/Page.\nexport default function App() {\n  const { isLoaded, loadError } = useLoadScript({\n    googleMapsApiKey: googleMapApiKey,\n  });\n  const [center, setCenter] = useState(dublinCenter);\n  const [zoom, setZoom] = useState(11);\n  // The things we need to track in state\n  const [selectedPlace, setSelectedPlace] = useState(null);\n  const [markerMap, setMarkerMap] = useState({});\n  const [infoOpen, setInfoOpen] = useState(false);\n\n  // const [origin, setOrigin] = useState([]);\n  // const [destination, setDestination] = useState({});\n\n  const [response, setResponse] = useState({});\n\n  const directionsCallback = React.useCallback((response) => {\n    console.log(\"hi, \", response);\n\n    if (response !== null) {\n      if (response.status === \"OK\") {\n        setResponse((response) => ({\n          response,\n        }));\n      } else {\n        console.log(\"response: \", response);\n      }\n    }\n  }, []);\n\n  const [markers, setMarkers] = React.useState([]);\n  const [selected, setSelected] = React.useState(null);\n\n  const mapRef = React.useRef();\n  const onMapLoad = React.useCallback((map) => {\n    mapRef.current = map;\n  }, []);\n\n  const panTo = React.useCallback(({ lat, lng }) => {\n    mapRef.current.panTo({ lat, lng });\n    mapRef.current.setZoom(16);\n    //\n    setMarkers((current) => [...current, { lat: lat, lng: lng }]);\n    console.log(markers);\n    // setOrigin((current) => [...current, { lat: lat, lng: lng }]);\n  }, []);\n\n  // We have to create a mapping of our places to actual Marker objects\n  const markerLoadHandler = (marker, stop) => {\n    return setMarkerMap((prevState) => {\n      return { ...prevState, [stop.properties.id]: marker };\n    });\n  };\n\n  const markerClickHandler = (event, place) => {\n    // Remember which stop was clicked\n    setSelectedPlace(place);\n    // Required so clicking a 2nd marker works as expected\n    if (infoOpen) {\n      setInfoOpen(false);\n    }\n    setInfoOpen(true);\n  };\n\n  if (loadError) return \"Error\";\n  if (!isLoaded) return \"Loading...\";\n\n  return (\n    <div>\n      <Container fluid>\n        <BrandBar></BrandBar>\n        <Wrapper style={{ width: \"75%\", float: \"left\" }}>\n          {/* Render the Google Map */}\n          <GoogleMap\n            mapContainerStyle={mapContainerStyle}\n            center={center}\n            zoom={zoom}\n            maxZoom={13}\n            options={mapOptions}\n            onLoad={onMapLoad}\n          >\n            <Locate panTo={panTo} />\n\n            <MarkerClusterer\n              options={options}\n              maxZoom={16}\n              minimumClusterSize={6}\n            >\n              {(clusterer) =>\n                myStops.map((stop) => (\n                  <Marker\n                    icon={icon}\n                    key={stop.properties.id}\n                    position={stop.geometry.pos}\n                    clusterer={clusterer}\n                    onLoad={(marker) => markerLoadHandler(marker, stop)}\n                    onClick={(event) => markerClickHandler(event, stop)}\n                  />\n                ))\n              }\n            </MarkerClusterer>\n\n            {infoOpen && selectedPlace && (\n              <InfoWindow\n                anchor={markerMap[selectedPlace.properties.id]}\n                onCloseClick={() => setInfoOpen(false)}\n              >\n                <div>\n                  <h3>Stop Number: {selectedPlace.properties.id}</h3>\n                  <h5>Routes: {selectedPlace.properties.routes.join(\", \")}</h5>\n                </div>\n              </InfoWindow>\n            )}\n            {/* Markers dropped on selection box choice. */}\n            {markers.map((marker) => (\n              <Marker\n                key={`${marker.lat}-${marker.lng}`}\n                position={{ lat: marker.lat, lng: marker.lng }}\n                onClick={() => {\n                  setSelected(marker);\n                }}\n              />\n            ))}\n            {destination !== \"\" && origin !== \"\" && (\n              <DirectionsService\n                // required\n                options={{\n                  origin: new window.google.maps.LatLng(\n                    53.3472419444,\n                    -6.2587911111\n                  ),\n                  destination: new window.google.maps.LatLng(\n                    53.3466669444,\n                    -6.258325\n                  ),\n                  travelMode: \"DRIVING\",\n                }}\n                // required\n                callback={directionsCallback}\n              />\n            )}\n            {response !== null && (\n              <DirectionsRenderer\n                // required\n                options={{\n                  directions: response,\n                }}\n              />\n            )}\n          </GoogleMap>\n        </Wrapper>\n\n        <Wrapper style={{ width: \"25%\", float: \"right\" }}>\n          <Container style={{ paddingTop: \"15vh\" }}>\n            <DateTimeSelector></DateTimeSelector>\n            <Form>\n              <Form.Group controlId=\"formDeparture\">\n                <Form.Label>Departure</Form.Label>\n                <Search panTo={panTo} />\n              </Form.Group>\n            </Form>\n            <Form>\n              <Form.Group controlId=\"formArrival\">\n                <Form.Label>Arrival</Form.Label>\n                <Search panTo={panTo} />\n              </Form.Group>\n            </Form>\n            {/* <button className=\"btn btn-primary\" type=\"button\" onClick={onClick}>\n              Build Route\n            </button> */}\n            {/* need to add an onclick event that relates to the database here. */}\n            {/* <Button variant=\"primary\" type=\"submit\" onClick>\n              Submit\n            </Button>\n            <Api></Api>\n            <ParentComponent></ParentComponent> */}\n          </Container>\n        </Wrapper>\n      </Container>\n    </div>\n  );\n}\n\n// Function to adjust the map to user location.\nfunction Locate({ panTo }) {\n  return (\n    <button\n      className=\"locate\"\n      onClick={() => {\n        navigator.geolocation.getCurrentPosition(\n          // Hard coding Dublin for the time being.\n          (position) => {\n            panTo({\n              // lat: position.coords.latitude,\n              // lng: position.coords.longitude,\n              lat: dublinCenter.lat,\n              lng: dublinCenter.lng,\n            });\n          },\n          () => null\n        );\n      }}\n    >\n      <img alt=\"compass\" src=\"/compass.svg\" />\n    </button>\n  );\n}\n\n// Function to adjust the map to user selected stop(s).\nfunction Search({ panTo }) {\n  return (\n    <div>\n      <Typeahead\n        id=\"basic-example\"\n        options={stopDescriptions}\n        maxVisible={2}\n        placeholder=\"Choose a stop...\"\n        onChange={(address) => {\n          try {\n            for (var i = 0; i < parsedStops.length; i++) {\n              if (address == parsedStops[i].description) {\n                const lat = parsedStops[i].geometry.lat,\n                  lng = parsedStops[i].geometry.lng;\n                panTo({ lat, lng });\n              }\n            }\n          } catch (error) {\n            console.log(\"error\");\n          }\n        }}\n      />\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}